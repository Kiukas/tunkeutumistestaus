a) Hanki kutsu HackTheBoxiin.
HackTheBox auki ja kutsua hakemaan. Ihan niin yksikertaista se ei ollut. Heti ensimmäisenä selaimesta konsoli auki F12:lla. Sitten varmuudeksi kokeilemaan mitä sivun vinkki painike tarjoaa, no konsolin avaamista tietenkin.
Suoraan konsoliin aukeaa kätevästi ohje (calm.js). Se neuvoo etsimään ajettavaa javascript tiedostoa "This page loads an interesting javascript file. See if you can find it :)"
Olettavasti oikea tiedosto löytyi https://www.hackthebox.eu/js/inviteapi.min.js ja se oli mukavasti kommentoitu hämärretyksi (obfuscated). Ensimmäinen virheeni oli avata se konsolissa "{}" painikkeella luettavampaan muotoon ja sen jälkeen koittaa saada selkokielelle. Johon paloi muutama hetki turhaan.

Koodi talteen ja kääntymään selkeämmäksi "Online JavaScript Beautifierilla" https://beautifier.io/  Sieltä paljastui oli jo aavistuksen painokelpoisempaa tavaraa.
//This javascript code looks strange...is it obfuscated???

function makeInviteCode() {
    $.ajax({
        type: "POST",
        dataType: "json",
        url: '/api/invite/how/to/generate',
        success: function(a) {
            console.log(a)
        },
        error: function(a) {
            console.log(a)
        }
    })
}

Sitten taas pyytämään lisätietoa tuolta edellisen kohdan tietojen pohjalta. Ylläoleva koodi ajoon konsoliin konsolista osoitteesta url kohtaan saakka ja sieltä löytyi lisätietoa base64 muodossa. Sen käänsin sivustolla https://www.base64decode.org/ ja viestinä oli "In order to generate the invite code, make a POST request to /api/invite/generate"
$.post('https://www.hackthebox.eu/api/invite/generate') ja taas siellä oli informaatiota base64 muodossa, se kääntöön selkokielelle ja pastetus invite-kenttään ja kutsu saavutettu. 


b) Asenna WebGoat ja kokeile, että pääset kirjautumaan sisään.
Valitsin versioksi aavistuksen vanhemman WebGoatin 7.1 docker version. Asensin se virtuaalisen Xubuntun päälle Docker hubin ohjeiden mukaisesti https://hub.docker.com/r/webgoat/webgoat-7.1/. Docker versio oli ilmeisesti liian vanha, koska sieltä puuttuivat itseltäni kaikki paitsi ensimmäinen “HTTP Basics” tehtävä. Ennen WebGoatin käyttöä siirsin virtuaalikoneen kytkimen taakse, jossa ei ollut pääsyä mihinkään sekä vielä käyttöjärjestelmän puolelta disabloin yhteydet GUIn kautta. Virtuaalisista kytkimistä lisää seuraavassa tehtävässä.


c) Ratkaise WebGoatista tehtävät "HTTP Basics", "Developer tools", "CIA Triad" ja "A1 Injection (intro)". Katso vinkit alta.
HTTP Basics
Katsottu miten pyyntö rakentuu selaimen sisäänrakennetulla kehittäjätyökalulla ja testattu lähettää omaa data. Se ei aivan täydellisesti vielä onnistunut: (+tämän jälkeen vaihdettu versio 8:n, jotta puuttuvat tehtävät voisi suorittaa)

Developer tools

Tehtävässä läpikäyty selaimen kehittäjätyökaluja ja sen sisältöä. Mistä avataan, mitä siellä on ja muutaman käyttökohde: konsolin käyttö, javascriptin ajoa sekä viimeisenä http pyynnön (request) sisältöä.
 
CIA Triad
Wikipedian tietoturva artikkelia lainaten (https://fi.wikipedia.org/wiki/Tietoturva) CIA kolmikko on malli, joka tarkoittaa tiedon saatavuuden, luottamuksellisuuden ja eheyden ylläpitämistä. Vastattu hyväksytysti kysymyksiin.
A1 Injection (intro)

Omat SQL taidot ovat täysin ruosteessa ja olemattomat eli kaikki aloitettiin aivan nollasta.

Ensimmäisten tehtävien kanssa paloi kohtuuttomasti aikaa, kun piti kerrata komentojen syntakseja. Lopulta olin kirjoittanut komennon melkein oikein, mutta etsittävän kohteen nimestä unohtui iso alkukirjain tms. 
 
Data Manipulation Language Seuraavassa manipuloitiin Kannan tietoja ja vaihdettiin Tobi Barnett Sales-osastolle. Ohessa kyseinen toimenpide:

Data Definition Language. Unohdin kaapata tuloksen seuraavasta tehtävästä. Joten se näkyy nyt virheellisesti harmaana. Kantaan lisättiin uusi tietue “phone”, joka oli 20 merkkiä pitkä.
 
SQL Injektioita en ole koskaan harrastanut, joten uusi aluevaltaus tässäkin ja lukuisia hetkiä erehdyksien parissa.
SQL kanssa paloi hyvin runsaasti aikaa, joten viimeiset kohdat oikoluin etusormiohjeiden voimin. Lähteenä käytin seuraavaa: https://gitlab.com/BlackSheepSpicy/WebGoat/-/blob/master/WebGoat%20SQL%20Injection%20(Introduction).pdf
d) Asenna Kali Linux virtuaalikoneeseen. Kokeile jotain Kalin mukana tulevaa työkalua paikalliseen localhost-osoitteeseen.
Kalin ja Xubuntu koneiden alustaksi valitsin Windowsin oman Hyper-V:n. Ei missään muodossa oma suosikkini, mutta liittyen muihin taustalla suoritettaviin kursseihin päätin jatkaa sen parissa. Kuten jo  edellisten tehtävän kanssa tuskailin. Suositellun VirtualBoxin kanssa olisi pitänyt käynnistää kone aina uudelleen, jos olisi halunnut vaihtaa hypervisorin tyyppiä. Wikipediaa (https://fi.wikipedia.org/wiki/Virtualisointi) lainaten Hyper-V on suoraan laitteistolla suoritettava (tyyppi 1) ja VirtualBox taas toisen käyttöjärjestelmän päällä suoritettava (tyyppi 2). Kurssia varten olin määrittänyt kolme erillistä virtuaalista kytkintä tulevia tehtäviä varten. Yhdelläkään kytkimellä ei ole määritetty laajennuksia (extensions):
-External = Ainoa kytkin josta pääsy internetiin hostin verkkokortilla. Sillä on myös pääsy hostille ja kaikille virtuaalikoneille, jotka liitetty tähän kytkimeen
-Internal = Ei pääsyä internetiin vain hostille ja muille virtuaalikoneille, jotka liitetty tähän kytkimeen
-Private = Ei pääsyä internetiin, yhteys ainoastaan laitteiden välillä jotka liitetty tähän kytkimeen
Asennus suoritettiin Kalin oman ohjeistuksen mukaan https://www.kali.org/docs/installation/hard-disk-install/. Päätin ensin salata levyn, mutta 60gb kokoisen levyn salaus kesti tolkuttoman kauan (jaksoin odottaa tunnin) ja päädyin lopulta salaamattomaan ratkaisuun. Ainoa muutos oletusasennukseen oli "Collectionin" vaihto largeksi eli default + muutama ylimääräinen työkalu, mahdollisen kokeilun nimissä. En ottanut kaappauksia vaiheista vaan kirjasin kriittiset koneen tiedot talteen omaan salattuun sijaintiin. Jotka jätän nyt julkaisematta. Samalla huomasin Hyper-V:hen liittyvän ongelman, jota en vielä saanut ratkaistua. Mikäli Xubuntua ei käytä noin 10 minuuttiin se lakkaa täysin vastaamasta. Ainoastaan pakotetusti sammuttaminen (power off) ja VM:n käynnistäminen uudelleen tämän jälkeen palauttaa koneen. Kali taas toimii täysin normaalisti. Siinä ikävästi menettää kaikki tallentamattomat muutokset. Nyt esiintyneet haasteet Hyper-V:n kanssa hidastavat oppimista tai sitten en vain osaa tuota Hyper-V:tä käyttää. Olettavasti tulen vaihtamaan alustan toiseen lähiviikkojen aikana.
Testasin NMAPia localhostia vasten ja varmuudeksi siirsin koneen kytkimen taakse, joka ei ollut verkossa.
Ajaen seuraavan komennon:

sudo nmap -v -F -O -A -sV localhost 
(Komento ajettu sudolla, koska käyttöoikeudet eivät muutoin olisi sallineet -O vipua käyttöjärjestelmän tunnistamiseen, eikä sitä edes tunnistettu)

-v: Increase verbosity level (use -vv or more for greater effect)
-F: Fast mode - Scan fewer ports than the default scan
-O: Enable OS detection (turha)
-A: Enable OS detection, version detection, script scanning, and traceroute
-sV: Probe open ports to determine service/version info

Alla näkymä virtuaalikoneelta. Toistaiseksi ei mitään jännää löytynyt näillä määrityksin.


Darknet Diaries:
Kuuntelin jakson 75: Compromised Comms, samalla kun taistelin SQL:n kanssa. Se ei ollut kovinkaan tekninen. Siinä käytiin lävitse enemmälti miten kyseenalaisesti salaista kirjeen vaihtoa agenttien välillä käytiin. Aivan sanatarkasti en sisältöä muista, mutta käytännössä viestintä käytiin julkisessa verkossa ja salaamattomilla verkkosivuilla. Josta sitten vieraat vallat nappasivat tiedot itselleen. Näin pariin riviin tiivistettynä.
